import{a as s}from "./chunk-RB3EWRZX.js";import{e as h,g as u,ha as m,i,j as r,m as p,na as g,p as n,ta as f,y as o}from "./chunk-54NRRIHP.js";var l=class a{#e=n(g);#r=n(f);#s=o(!1);#t=o("");#i=o(void 0);register(e){return this.#e.post(`${s.authUrl}/register`,e).pipe(r(t=>{this.#r.navigate(["/logowanie"])}),i(t=>{throw this.#t.set(t.error),new Error(t.error)}))}login(e){return this.#e.post(`${s.authUrl}/login`,e).pipe(r(t=>{t.token&&(localStorage.setItem("token",t.token),this.authenticated.set(!0),this.#i.set({username:e.username}),this.navigateHome())}),i(t=>{throw this.authenticated.set(!1),this.#t.set(t.error),new Error(t.error)}))}#o(){return this.#e.post(`${s.authUrl}/verify`,{}).pipe(r(e=>{this.#i.set({username:e}),this.authenticated.set(!0)}),u(()=>!0),i(e=>(this.authenticated.set(!1),h(!1))))}verifyAuthenticated(){return this.#o()}verifyToken(){return this.#o().pipe(r(e=>{e||this.logout()}))}logout(){localStorage.removeItem("token"),this.authenticated.set(!1),this.#r.navigate(["logowanie"])}navigateHome(){this.#r.navigate(["/"])}clearMessage(){this.#t.set("")}get authenticated(){return this.#s}get message(){return this.#t}get user(){return m(()=>this.#i())}static \u0275fac=function(t){return new(t||a)};static \u0275prov=p({token:a,factory:a.\u0275fac,providedIn:"root"})};export{l as a};
